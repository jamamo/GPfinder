{% extends 'base.html' %}
{% block title %}Admin Dashboard{% endblock %}

{% block content %}
<div class="admin-header">
  <div>
    <h2>Admin Dashboard</h2>
    <p class="muted">{{ total }} practices in database</p>
  </div>
  <a href="{{ url_for('admin_add') }}" class="btn-primary">+ Add Practice</a>
</div>

<form action="{{ url_for('admin_dashboard') }}" method="get" class="search-form admin-search">
  <div class="search-row">
    <input type="text" name="q" value="{{ query }}" placeholder="Filter by name, postcode, code&hellip;"
           autocomplete="off" class="search-input">
    <button type="submit" class="btn-secondary">Filter</button>
    {% if query %}<a href="{{ url_for('admin_dashboard') }}" class="btn-ghost">Clear</a>{% endif %}
  </div>
</form>

<div class="table-wrap">
  <table class="admin-table">
    <thead>
      <tr>
        <th>Practice Name</th>
        <th>Code</th>
        <th>Postcode</th>
        <th>Telephone</th>
        <th>Region</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      {% for gp in gps %}
      <tr>
        <td><a href="{{ url_for('gp_detail', gp_id=gp['id']) }}">{{ gp['practice_name'] }}</a></td>
        <td class="mono">{{ gp['practice_code'] or '—' }}</td>
        <td class="mono">{{ gp['postcode'] or '—' }}</td>
        <td>{{ gp['telephone'] or '—' }}</td>
        <td>{{ gp['region'] or '—' }}</td>
        <td class="actions">
          <a href="{{ url_for('admin_edit', gp_id=gp['id']) }}" class="link-edit">Edit</a>
          <form action="{{ url_for('admin_delete', gp_id=gp['id']) }}" method="post" style="display:inline"
                onsubmit="return confirm('Remove {{ gp['practice_name']|e }}?')">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            <button type="submit" class="link-delete">Delete</button>
          </form>
        </td>
      </tr>
      {% else %}
      <tr><td colspan="6" class="empty-row">No practices found.</td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
